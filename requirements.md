# Local Sidekick 企画・仕様ドキュメント（macOS優先 / Hackathon対応）

> 常時カメラ観測とPC利用状況から、ユーザーの状態（眠気・集中・散漫）を自動推定し、必要なときだけ介入して「1日が無駄に溶ける」を減らす。

---

## 1. 背景

### 1.1 解決したい課題

- 仕事をしているつもりでも、気づくと時間が溶けている（成果感が残らない）
- 集中が切れた・眠い・だらだらしていることを自覚するタイミングが遅い
- 従来の生産性ツール（タイマー、ToDo、習慣化アプリ）は「ユーザーが操作すること」が前提で、継続利用が難しい
- 生成AI/LLMを使う生産性ツールは、入力データ（行動・画面・文章）が外部に出る不安が導入障壁になりやすい

### 1.2 このプロダクトが狙うポジション

- 「手入力」でも「単なるタイマー」でもなく、**常時観測による自動判断**が核
- “監視ツール”ではなく、**個人の自己理解と改善のためのコーチ/マネージャー**として設計
- プライバシーの不安を最小化するため、**オンデバイス推定（映像を外に出さない）**を原則とする

---

## 2. 目的

### 2.1 目的（一次）

- **「1日が無駄に溶ける」を減らす**
  - 眠気・散漫・停滞を早期に検知し、最小限の介入で作業に戻す

### 2.2 目的（二次）

- ユーザーの“溶け”の原因を可視化し、翌日以降の改善につなげる
- 自己申告や手入力を極小化し、継続利用を成立させる

---

## 3. コンセプト

### 3.1 コアコンセプト（1行）

- **Always-on observer that intervenes only when needed.**
  - 常時観測して、必要なときだけ介入する「個人の右腕」。

### 3.2 体験コンセプト

- ユーザーは基本的に何もしない（起動しておくだけ）
- 作業中の“状態変化”を検知し、介入は「短く・少なく・即実行」に限定
- 1日の終わりに、「今日の溶け」と「明日の一手」だけが返ってくる

---

## 4. 特徴（差別化）

### 4.1 常時カメラによる状態推定（必須要件）

- カメラが捉える対象：**ユーザーの顔・視線・姿勢・動き**
- 推定対象（例）：
  - 眠気：瞬目頻度、まぶた開度（PERCLOS的）、あくび推定、頭部の揺れ/うつむき
  - 集中：視線安定度、姿勢安定、表情変化の少なさ
  - 離席：顔不在

### 4.2 PC利用状況（メタデータ）との統合

- 取得対象（内容は取得しない）：
  - キーボード/マウス活動密度、アイドル時間
  - アプリ切替頻度、ウィンドウ切替頻度（コンテキストスイッチ）
- 目的：カメラだけでは判定しづらい「溶け（散漫・停滞）」の検知精度を上げる

### 4.3 プライバシー・安心設計

- 原則：**映像は端末外へ出さない（デフォルト）**
- サーバへ送るのは統計/特徴量/メタ情報のみ（本文・画面・キー入力内容は送らない）
- “監視感”の軽減：
  - 常時インジケータ（カメラ稼働が視覚的に分かる）
  - 収集データの透明化（「何を取っているか」をUIで確認可能）
  - 強制停止ホットキー/ワンクリック停止

### 4.4 介入の最小化（通知設計が価値）

- 通知は原則3タイプに限定（増やさない）：
  1. 眠気（起こす）
  2. 散漫（戻す）
  3. 過集中（休ませる）
- “通知がうるさい”問題を避けるため、発火条件は厳しめに設計

---

## 5. 仕様（macOS優先）

### 5.1 対象ユーザー（初期）

- PC前で長時間作業する知的労働者（エンジニア、PM、フリーランス等）
- 価値が刺さる状況：
  - 午後に眠気が来る
  - 通知・SNS・割り込みで分断される
  - 1日が終わっても成果感が残らない

### 5.2 動作要件（重要）

- macOS常駐アプリ（メニューバー常駐）
- カメラ常時利用（ユーザー許諾が前提）
- 低負荷・低発熱・低バッテリー消費を重視（特にラップトップ）
- オフラインでも基本機能が動作（推定はオンデバイス）

### 5.3 収集データ（MVP）

#### カメラ由来（オンデバイス処理）

- 顔ランドマーク / 視線・姿勢の特徴量
- 眠気スコア・集中スコアなどの推定結果（時系列）

#### OS/アプリ由来（メタ）

- アクティブアプリ名（もしくはカテゴリ）
- アプリ/ウィンドウ切替回数
- 入力デバイス活動密度（キーボード/マウスのイベント量）
- アイドル時間

> **取得しないもの（方針）**

- キー入力内容（キーロガー的挙動）
- 画面キャプチャや閲覧内容
- カメラ映像のクラウド保存（デフォルトOFF）

### 5.4 状態推定（MVP）

- スコア（0〜100）で保持し、UIは3段階表示に丸める
  - 眠気：低/中/高
  - 集中：深い/浅い/断続
  - 離席：在席/不在
- “溶け”推定（例）：
  - 散漫：切替頻度↑ + 視線/姿勢の不安定↑
  - 停滞：操作はあるが集中スコア低 + 切替↑
  - 眠気：眠気高 + 操作密度低

### 5.5 介入（通知）仕様

#### 通知A：眠気

- 条件例：眠気高が一定時間継続 + 操作密度低下
- 通知文例：「眠気が来ています。90秒立つ？」

#### 通知B：散漫（溶け）

- 条件例：切替頻度が閾値超 + 集中が低い状態が継続
- 通知文例：「今、分断が増えています。10分だけ1タスクに固定しますか？」

#### 通知C：過集中

- 条件例：深い集中が長時間継続 + 休憩なし
- 通知文例：「集中が続きすぎています。2分休憩で効率維持しませんか？」

#### ワンクリック実行（MVP）

- タイマー開始（2分/10分など）
- 通知ミュート（macOSのFocus/Do Not Disturb誘導）
- “あとで”でスヌーズ

> **自動でアプリを閉じる/ブロックする**はMVPでは行わない（反発と事故リスクが高い）

### 5.6 日次レポート（MVP）

- 1日の終わりに自動生成（ローカルで閲覧）
- 内容：
  - 推定集中ブロック（時間帯）
  - 溶け時間推定（眠気/散漫/停滞/離席）
  - 介入が効いた回数（通知→復帰）
  - 明日の「一手」提案（1つだけ）

### 5.7 設定（MVP）

- 稼働時間（例：9:00-19:00）
- 通知頻度の上限（例：最大3回/日）
- カメラON/OFF（ただし本コンセプト上はON推奨）
- プライバシー設定：
  - 映像保存：OFF固定（将来オプション）
  - サーバ送信：統計のみ / 完全ローカル

---

## 6. アーキテクチャ方針（概要）

### 6.1 クライアント（macOS常駐）

- 役割：
  - カメラ入力取得
  - オンデバイス特徴抽出・推定
  - OSメタデータ収集（許諾範囲内）
  - 通知と日次レポート表示
- 技術候補（実装は別途判断）：
  - Tauri / Electron / ネイティブSwift
  - 顔特徴抽出：MediaPipe等の軽量モデル

### 6.2 サーバ（SaaS）

- 役割：
  - 認証、課金、デバイス同期（統計/設定）
  - 組織機能（Enterprise向け）
- Google Cloud（ハッカソン要件対応）：
  - Cloud Run（API）
  - Firestore（ユーザー/設定/統計）
  - Cloud Storage（配布物/モデル/設定ファイル）

### 6.3 LLMの使いどころ（任意）

- MVPでは必須にしない（推定の核はオンデバイス）
- 使うなら限定的：
  - 日次レポートの文章化（特徴量/統計のみ入力）
  - 改善提案の自然言語生成（機微情報を含めない）

---

## 7. ロードマップ

### Phase 0（ハッカソンMVP / 2〜6週間）

- macOS常駐アプリ（メニューバー常駐）
- カメラ常時取得 + 顔特徴量から眠気/集中スコア推定（簡易）
- アプリ切替/入力密度の取得
- 通知（眠気/散漫/過集中）3種
- 日次レポート（ローカル）
- Cloud Run + Firestore で認証・設定同期（最小）

### Phase 1（個人向けSaaSとしての継続率改善）

- 精度改善（誤検知削減、個人適応）
- 通知のパーソナライズ（時間帯/作業タイプ）
- iPhoneアプリ：通知受信・日次閲覧・設定（観測はPC主体）
- “完全ローカルモード”の提供（サーバ送信ゼロ）

### Phase 2（Pro機能・課金）

- デバイス横断の履歴閲覧（統計のみ同期）
- 週次/月次レポート、改善実験（A/B）
- 自動スケジューリング提案（休憩・深い作業枠）

### Phase 3（Enterprise版）

- SSO（SAML/OIDC）、SCIM、RBAC
- データ保持ポリシー、監査ログ
- 個人監視にならない集計ダッシュボード（匿名化・集約）
- 専用環境（VPC/リージョン固定/BYOK）

---

## 8. ハッカソンの範囲（Google Cloud Japan AI Hackathon Vol.4）

### 8.1 最低要件の満たし方（方針）

- 「Google Cloudのアプリ実行プロダクト」＋「AI技術」を組み合わせる
  - アプリ実行：Cloud Run（バックエンドAPI）
  - AI技術：オンデバイス推定（顔特徴抽出・状態推定）＋（任意で）Vertex AIにより日次レポート文章化

> Hackathon提出物：GitHub / デプロイURL / Zenn記事  
> 期間：2025/12/10〜2026/2/15  
> （詳細はハッカソンページに準拠）

### 8.2 Hackathon MVPとして実装する範囲（明示）

- macOS常駐クライアント
  - カメラ入力 → 簡易状態推定（眠気/集中）
  - OSメタデータ取得（アプリ切替・入力密度）
  - 通知3種
  - 日次レポート生成（ローカル）
- Cloud Run API（最小）
  - ユーザー認証（簡易）
  - 設定同期（稼働時間・通知上限）
  - 統計アップロード（オプション）

### 8.3 Hackathonでやらないこと（スコープ外）

- 映像のクラウド保存
- 画面キャプチャ解析
- キー入力内容取得
- 企業向けSSO/監査機能
- 高精度モデルの学習（MVPは推定ロジック中心）

---

## 9. リスクと対策

### 9.1 監視ツールに見えるリスク

- 対策：
  - デフォルトで映像送信なし
  - 収集データの透明化UI
  - “個人のため”を徹底（Enterpriseでも個人監視不可設計）

### 9.2 誤検知によるストレス

- 対策：
  - 通知回数上限
  - 発火条件を厳しめに（精度よりUX優先）
  - “スヌーズ/無視”学習（Phase 1）

### 9.3 バッテリー・発熱

- 対策：
  - 低FPS/間引き推論
  - 離席時は停止
  - 省電力モード

### 9.4 ストア審査・権限周り

- 対策：
  - 収集対象をメタデータ中心にし、内容取得を避ける
  - 常時カメラ利用の必要性を明確化（眠気/集中推定）

---

## 10. 成功指標（MVP）

- D7継続率
- 1日の通知受容率（通知→行動が変わった比率）
- 推定溶け時間の減少（自己申告ではなく、行動指標で推定）
- “不快”フィードバック率（監視感・通知がうるさい等）
